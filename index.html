<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Forex News Tracker</title>
    <style>
        :root {
            --primary-bg: #0d1117;
            --card-bg: #161b22;
            --text-primary: #c9d1d9;
            --high-impact: #ff4444;
            --medium-impact: #ffaa44;
            --low-impact: #44aaff;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, sans-serif;
        }

        body {
            background: var(--primary-bg);
            color: var(--text-primary);
            min-height: 100vh;
            padding: 1rem;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 2rem;
            padding: 1rem;
            border-bottom: 1px solid #30363d;
        }

        .events-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
            padding: 1rem;
        }

        .event-card {
            background: var(--card-bg);
            border-radius: 8px;
            padding: 1.5rem;
            border-left: 4px solid;
            transition: transform 0.2s;
            cursor: pointer;
        }

        .event-card:hover {
            transform: translateY(-3px);
        }

        .currency-pair {
            font-weight: 600;
            color: #00ffaa;
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }

        .event-time {
            color: #8b949e;
            font-size: 0.9rem;
            margin-bottom: 0.8rem;
        }

        .event-title {
            font-size: 1rem;
            margin-bottom: 1rem;
        }

        .impact-high { border-color: var(--high-impact); }
        .impact-medium { border-color: var(--medium-impact); }
        .impact-low { border-color: var(--low-impact); }

        .loading {
            text-align: center;
            padding: 2rem;
            color: #44aaff;
        }

        .error {
            color: #ff4444;
            text-align: center;
            padding: 2rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Forex Market Events</h1>
            <p>Real-time economic news impact analysis</p>
        </div>
        
        <div id="events-container" class="events-grid">
            <div class="loading">Loading market events...</div>
        </div>
    </div>

<script>
const API_KEY = 'RI1665KI0AHAUBNL'; // 1KCA5GKR715QMF24
const NEWS_URL = `https://www.alphavantage.co/query?function=NEWS_SENTIMENT&apikey=${API_KEY}`;

async function fetchEvents() {
    try {
        const response = await fetch(NEWS_URL);
        if (!response.ok) throw new Error('Network response was not ok');
        
        const data = await response.json();
        if (!data.feed || !Array.isArray(data.feed)) {
            throw new Error('Invalid API response format');
        }
        
        processEvents(data.feed);
    } catch (error) {
        showError(error.message);
    }
}

function processEvents(events) {
    const container = document.getElementById('events-container');
    container.innerHTML = '';

    const majorCurrencies = ['USD', 'EUR', 'JPY', 'GBP', 'CHF', 'CAD', 'AUD'];
    
    const filteredEvents = events.filter(event => {
        const title = event.title.toUpperCase();
        return majorCurrencies.some(currency => title.includes(currency));
    });

    if (filteredEvents.length === 0) {
        container.innerHTML = '<div class="error">No relevant forex events found</div>';
        return;
    }

    filteredEvents.slice(0, 50).forEach(event => {
        const card = createEventCard(event);
        container.appendChild(card);
    });
}

function createEventCard(event) {
    const card = document.createElement('div');
    const impactClass = getImpactClass(event.overall_sentiment_score);
    const currencies = getCurrenciesFromTitle(event.title);
    const time = formatTime(event.time_published);

    card.className = `event-card ${impactClass}`;
    card.innerHTML = `
        <div class="currency-pair">${currencies.join(' / ')}</div>
        <div class="event-time">${time}</div>
        <div class="event-title">${event.title}</div>
        <div style="color: ${getImpactColor(impactClass)}; margin-top: 0.5rem;">
            Impact: ${event.overall_sentiment_label || 'N/A'}
        </div>
    `;

    return card;
}

function getCurrenciesFromTitle(title) {
    const currencies = ['USD', 'EUR', 'JPY', 'GBP', 'CHF', 'CAD', 'AUD'];
    const found = currencies.filter(currency => 
        title.toUpperCase().includes(currency)
    );
    return found.length > 0 ? found : ['Global'];
}

function formatTime(timeString) {
    try {
        const date = new Date(timeString);
        return date.toLocaleString('en-US', {
            month: 'short',
            day: 'numeric',
            hour: 'numeric',
            minute: '2-digit'
        });
    } catch {
        return 'Time unavailable';
    }
}

function getImpactClass(score) {
    const numScore = parseFloat(score);
    if (numScore >= 0.7) return 'impact-high';
    if (numScore >= 0.4) return 'impact-medium';
    return 'impact-low';
}

function getImpactColor(impactClass) {
    return {
        'impact-high': '#ff4444',
        'impact-medium': '#ffaa44',
        'impact-low': '#44aaff'
    }[impactClass];
}

function showError(message) {
    const container = document.getElementById('events-container');
    container.innerHTML = `
        <div class="error">
            <h3>⚠️ Error Loading Data</h3>
            <p>${message}</p>
            <p>Please check your API key and internet connection</p>
        </div>
    `;
}

// Initial load
fetchEvents();
// Refresh every 5 minutes
setInterval(fetchEvents, 300000);
</script>
</body>
</html>
