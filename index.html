<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional Forex News Tracker</title>
    <style>
        :root {
            --primary-bg: #0d1117;
            --card-bg: #161b22;
            --text-primary: #c9d1d9;
            --high-impact: #ff4444;
            --medium-impact: #ffaa44;
            --low-impact: #44aaff;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, sans-serif;
        }

        body {
            background: var(--primary-bg);
            color: var(--text-primary);
            min-height: 100vh;
            padding: 1rem;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 2rem;
            padding: 1rem;
            border-bottom: 1px solid #30363d;
        }

        .events-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
            padding: 1rem;
        }

        .event-card {
            background: var(--card-bg);
            border-radius: 8px;
            padding: 1.5rem;
            border-left: 4px solid;
            transition: transform 0.2s;
            cursor: pointer;
            position: relative;
        }

        .event-card:hover {
            transform: translateY(-3px);
        }

        .currency-pair {
            font-weight: 600;
            color: #00ffaa;
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }

        .event-time {
            color: #8b949e;
            font-size: 0.9rem;
            margin-bottom: 0.8rem;
        }

        .event-title {
            font-size: 1rem;
            margin-bottom: 1rem;
        }

        .impact-high { border-color: var(--high-impact); }
        .impact-medium { border-color: var(--medium-impact); }
        .impact-low { border-color: var(--low-impact); }

        .loading {
            text-align: center;
            padding: 2rem;
            color: #44aaff;
        }

        .error {
            color: #ff4444;
            text-align: center;
            padding: 2rem;
        }

        @media (max-width: 768px) {
            .events-grid {
                grid-template-columns: 1fr;
            }
            
            .event-card {
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Forex Market Events</h1>
            <p>Real-time economic news impact analysis</p>
        </div>
        
        <div id="events-container" class="events-grid">
            <div class="loading">Loading market events...</div>
        </div>
    </div>

<script>
const API_KEY = '1KCA5GKR715QMF24'; // Replace with your API key
const NEWS_URL = `https://www.alphavantage.co/query?function=NEWS_SENTIMENT&topics=forex&apikey=${API_KEY}`;

async function fetchEvents() {
    try {
        const response = await fetch(NEWS_URL);
        if (!response.ok) throw new Error('API request failed');
        
        const data = await response.json();
        if (!data?.feed?.length) throw new Error('No news data available');
        
        processEvents(data.feed);
    } catch (error) {
        showError(error.message);
    }
}

function processEvents(events) {
    const container = document.getElementById('events-container');
    container.innerHTML = '';

    const majorCurrencies = ['USD', 'EUR', 'JPY', 'GBP', 'CHF', 'CAD', 'AUD'];
    
    events.slice(0, 50).forEach(event => {
        const currencies = getCurrenciesFromEvent(event);
        if (currencies.length > 0) {
            const card = createEventCard(event, currencies);
            container.appendChild(card);
        }
    });

    if (container.children.length === 0) {
        container.innerHTML = '<div class="error">No relevant forex events found</div>';
    }
}

function createEventCard(event, currencies) {
    const card = document.createElement('div');
    const impactClass = getImpactClass(event.overall_sentiment_score);
    const time = formatTime(event.time_published);
    const impactText = event.overall_sentiment_label || 'Market Event';

    card.className = `event-card ${impactClass}`;
    card.innerHTML = `
        <div class="currency-pair">${currencies.join(' / ')}</div>
        <div class="event-time">${time}</div>
        <div class="event-title">${event.title}</div>
        <div style="color: ${getImpactColor(impactClass)}; margin-top: 0.5rem;">
            ${impactText} (${getImpactStrength(event.overall_sentiment_score)})
        </div>
    `;

    card.addEventListener('click', () => showEventDetails(event, currencies));
    return card;
}

function showEventDetails(event, currencies) {
    const impact = parseFloat(event.overall_sentiment_score);
    const analysis = generateImpactAnalysis(currencies, impact);
    
    const modal = document.createElement('div');
    modal.style.position = 'fixed';
    modal.style.top = '0';
    modal.style.left = '0';
    modal.style.width = '100%';
    modal.style.height = '100%';
    modal.style.backgroundColor = 'rgba(0,0,0,0.9)';
    modal.style.padding = '2rem';
    modal.style.zIndex = '1000';
    
    modal.innerHTML = `
        <div style="background: #161b22; padding: 2rem; border-radius: 8px; max-width: 600px; margin: 2rem auto; position: relative;">
            <button onclick="this.parentElement.parentElement.remove()" style="position: absolute; top: 1rem; right: 1rem; background: none; border: none; color: #fff; cursor: pointer; font-size: 1.5rem;">√ó</button>
            <h2 style="margin-bottom: 1rem;">${event.title}</h2>
            <div style="margin-bottom: 1.5rem;">
                <div class="currency-pair">${currencies.join(' / ')}</div>
                <div class="event-time">${formatTime(event.time_published)}</div>
            </div>
            <div style="background: rgba(255,255,255,0.05); padding: 1.5rem; border-radius: 8px;">
                <h3 style="margin-bottom: 1rem;">üìà Market Impact Analysis</h3>
                <p>${analysis}</p>
                ${event.summary ? `<p style="margin-top: 1rem;">${event.summary}</p>` : ''}
            </div>
            ${event.url ? `<a href="${event.url}" target="_blank" style="display: block; margin-top: 1.5rem; color: #44aaff; text-decoration: none;">üì∞ Read Full Report ‚Üí</a>` : ''}
        </div>
    `;

    document.body.appendChild(modal);
}

function generateImpactAnalysis(currencies, impactScore) {
    const [baseCurrency, quoteCurrency] = currencies;
    const strength = impactScore >= 0.5 ? 'strengthen' : 'weaken';
    const volatility = impactScore >= 0.7 ? 'high volatility' : impactScore >= 0.4 ? 'moderate volatility' : 'low volatility';
    
    return `This event is expected to ${strength} ${baseCurrency} against ${quoteCurrency || 'major currencies'}, 
    with potential for ${volatility}. Traders should watch for ${impactScore >= 0.5 ? 'bullish' : 'bearish'} 
    patterns in the ${baseCurrency}${quoteCurrency ? '/'+quoteCurrency : ''} pair.`;
}

function getCurrenciesFromEvent(event) {
    const currencies = ['USD', 'EUR', 'JPY', 'GBP', 'CHF', 'CAD', 'AUD'];
    const titleCurrencies = currencies.filter(c => event.title.toUpperCase().includes(c));
    const tickerCurrencies = (event.ticker_sentiment || [])
        .map(t => t.ticker.split(':')[1])
        .filter(c => currencies.includes(c));
    
    return [...new Set([...titleCurrencies, ...tickerCurrencies])].slice(0, 2);
}

function formatTime(timeString) {
    try {
        const date = new Date(timeString);
        return date.toLocaleString('en-US', {
            month: 'short',
            day: 'numeric',
            hour: 'numeric',
            minute: '2-digit',
            hour12: true
        });
    } catch {
        return 'Time unavailable';
    }
}

function getImpactClass(score) {
    const numScore = parseFloat(score);
    if (numScore >= 0.7) return 'impact-high';
    if (numScore >= 0.4) return 'impact-medium';
    return 'impact-low';
}

function getImpactColor(impactClass) {
    return {
        'impact-high': '#ff4444',
        'impact-medium': '#ffaa44',
        'impact-low': '#44aaff'
    }[impactClass];
}

function getImpactStrength(score) {
    const numScore = parseFloat(score);
    if (numScore >= 0.7) return 'High Impact';
    if (numScore >= 0.4) return 'Medium Impact';
    return 'Low Impact';
}

function showError(message) {
    const container = document.getElementById('events-container');
    container.innerHTML = `
        <div class="error">
            <h3>‚ö†Ô∏è Error Loading Data</h3>
            <p>${message}</p>
            <p>Please check your API key and try again later</p>
        </div>
    `;
}

// Initial load
fetchEvents();
// Refresh every 5 minutes
setInterval(fetchEvents, 300000);
</script>
</body>
</html>
