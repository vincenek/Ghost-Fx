<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pro Forex Event Matrix</title>
    <style>
        :root {
            --primary-bg: #0a0e14;
            --card-bg: #1d232a;
            --text-primary: #cbd0d7;
            --high-impact: #ff3366;
            --medium-impact: #ffaa44;
            --low-impact: #44aaff;
            --neutral-impact: #00cc88;
            --timeline: #2d3746;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'SF Pro Display', system-ui, sans-serif;
        }

        body {
            background: var(--primary-bg);
            color: var(--text-primary);
            min-height: 100vh;
            padding: 2rem;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }

        .timeline-section {
            position: relative;
            padding: 1rem;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 50%;
            width: 2px;
            height: 100%;
            background: var(--timeline);
        }

        .event-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            position: relative;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            border-left: 4px solid;
        }

        .event-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
        }

        .impact-high { border-color: var(--high-impact); }
        .impact-medium { border-color: var(--medium-impact); }
        .impact-low { border-color: var(--low-impact); }
        .impact-neutral { border-color: var(--neutral-impact); }

        .event-time {
            font-size: 0.9rem;
            color: #7a828d;
            margin-bottom: 0.5rem;
        }

        .currency-pair {
            font-weight: 600;
            color: #00ffaa;
            margin-bottom: 0.5rem;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            padding: 2rem;
            overflow-y: auto;
        }

        .modal-content {
            background: var(--card-bg);
            max-width: 800px;
            margin: 2rem auto;
            padding: 2rem;
            border-radius: 16px;
            position: relative;
        }

        .close-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            cursor: pointer;
            font-size: 1.5rem;
        }

        .analysis-section {
            margin-top: 1.5rem;
            padding: 1rem;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
        }

        .impact-tag {
            display: inline-block;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            margin-bottom: 1rem;
        }

        .loading {
            text-align: center;
            padding: 2rem;
            font-size: 1.2rem;
            color: #44aaff;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="timeline-section">
            <h2>üìà Upcoming Events</h2>
            <div id="future-events" class="timeline">
                <div class="loading">Loading future events...</div>
            </div>
        </div>
        <div class="timeline-section">
            <h2>üìâ Past Events</h2>
            <div id="past-events" class="timeline">
                <div class="loading">Loading past events...</div>
            </div>
        </div>
    </div>

    <div id="event-modal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal()">&times;</span>
            <div id="modal-content"></div>
        </div>
    </div>

<script>
const API_KEY = 'RI1665KI0AHAUBNL'; // üîë RI1665KI0AHAUBNL
const NEWS_URL = `https://www.alphavantage.co/query?function=NEWS_SENTIMENT&topics=forex&apikey=${API_KEY}`;

let allEvents = [];

async function fetchEvents() {
    try {
        showLoading(true);
        const response = await fetch(NEWS_URL);
        const data = await response.json();
        allEvents = data.feed || [];
        processEvents();
    } catch (error) {
        handleError();
    } finally {
        showLoading(false);
    }
}

function processEvents() {
    const now = new Date();
    const pastEvents = [];
    const futureEvents = [];

    allEvents.forEach(event => {
        const eventDate = new Date(event.time_published);
        const card = createEventCard(event, eventDate);
        
        eventDate < now ? pastEvents.push(card) : futureEvents.push(card);
    });

    document.getElementById('past-events').innerHTML = pastEvents.join('');
    document.getElementById('future-events').innerHTML = futureEvents.join('');
    addCardInteractions();
}

function createEventCard(event, eventDate) {
    const impactClass = getImpactClass(event.overall_sentiment_score);
    return `
        <div class="event-card ${impactClass}" data-event='${JSON.stringify(event).replace(/'/g, "&apos;")}'>
            <div class="impact-tag" style="background: ${getImpactColor(impactClass)}20; color: ${getImpactColor(impactClass)}">
                ${event.overall_sentiment_label || 'Event'}
            </div>
            <div class="currency-pair">${getCurrencyPairs(event.title)}</div>
            <div class="event-time">${eventDate.toLocaleString()}</div>
            <h3>${event.title}</h3>
        </div>
    `;
}

function showEventDetails(event) {
    const modalContent = `
        <h2>${event.title}</h2>
        <div class="event-time">${new Date(event.time_published).toLocaleString()}</div>
        <div class="currency-pair">Affected Pairs: ${getCurrencyPairs(event.title)}</div>
        
        <div class="analysis-section">
            <h3>üíπ Market Impact Analysis</h3>
            <p>${generateAnalysis(event)}</p>
            ${event.summary ? `<p><strong>Summary:</strong> ${event.summary}</p>` : ''}
            ${event.url ? `<a href="${event.url}" target="_blank" style="color: #44aaff;">Read Full Report ‚Üí</a>` : ''}
        </div>
    `;
    
    document.getElementById('modal-content').innerHTML = modalContent;
    document.getElementById('event-modal').style.display = 'block';
}

function generateAnalysis(event) {
    const pairs = getCurrencyPairs(event.title);
    const score = parseFloat(event.overall_sentiment_score);
    const [baseCurrency, quoteCurrency] = pairs.split('/');
    
    let analysis = `This ${getImpactLabel(score)} event typically affects `;
    analysis += `${baseCurrency} valuation. Historically, similar events have caused `;
    analysis += `${score >= 0.5 ? '1.5-3%' : '0.5-1.2%'} movements in the ${pairs} pair. `;
    analysis += `Traders should watch for ${score >= 0.5 ? 'breakout' : 'range-bound'} patterns `;
    analysis += `around key ${score >= 0.5 ? 'resistance' : 'support'} levels.`;
    
    return analysis;
}

function getImpactLabel(score) {
    if (score >= 0.7) return 'high-impact';
    if (score >= 0.4) return 'medium-impact';
    return 'low-impact';
}

function getCurrencyPairs(title) {
    const currencies = ['USD', 'EUR', 'JPY', 'GBP', 'CHF', 'CAD', 'AUD', 'NZD'];
    const found = currencies.filter(currency => title.toUpperCase().includes(currency));
    return found.length >= 2 ? `${found[0]}/${found[1]}` : 'Major Pairs';
}

function getImpactClass(score) {
    const numScore = parseFloat(score);
    if (numScore >= 0.7) return 'impact-high';
    if (numScore >= 0.4) return 'impact-medium';
    return numScore >= 0.1 ? 'impact-low' : 'impact-neutral';
}

function getImpactColor(impactClass) {
    const colors = {
        'impact-high': '#ff3366',
        'impact-medium': '#ffaa44',
        'impact-low': '#44aaff',
        'impact-neutral': '#00cc88'
    };
    return colors[impactClass] || '#44aaff';
}

function addCardInteractions() {
    document.querySelectorAll('.event-card').forEach(card => {
        card.addEventListener('click', () => {
            const eventData = JSON.parse(card.dataset.event.replace(/&apos;/g, "'"));
            showEventDetails(eventData);
        });
    });
}

function closeModal() {
    document.getElementById('event-modal').style.display = 'none';
}

function showLoading(show) {
    document.querySelectorAll('.loading').forEach(el => {
        el.style.display = show ? 'block' : 'none';
    });
}

function handleError() {
    const container = document.getElementById('news-container');
    container.innerHTML = '<div class="news-card">‚ö†Ô∏è Error fetching market data. Please try again later.</div>';
}

// Initial load
fetchEvents();
setInterval(fetchEvents, 300000);

// Close modal on outside click
window.onclick = function(event) {
    const modal = document.getElementById('event-modal');
    if (event.target === modal) {
        closeModal();
    }
}
</script>
</body>
</html>
